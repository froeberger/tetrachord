(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Input::Initialization:: *)
Unprotect[tetrachords] ;
tetrachords = <| 1->{80/79,79/78,13/10},2->{60/49,118/117,13/10},3->{120/119,66/65,13/10},4->{100/99,66/65,13/10},5->{72/71,71/70,35/27},6->{108/107,107/105,35/27},7->{54/53,106/105,35/27},8->{64/63,81/80,35/27},9->{68/67,67/66,22/17},10->{51/50,100/99,22/17},11->{102/101,101/99,22/17},12->{85/84,56/55,22/17},13->{66/65,65/64,128/99},14->{99/98,49/48,128/99},15->{99/97,97/96,128/99},16->{64/63,63/62,31/24},17->{96/95,95/93,31/24},18->{48/47,94/93,31/24},19->{62/61,61/60,40/31},20->{93/92,46/45,40/31},21->{93/91,91/90,40/31},22->{60/59,59/58,58/45},23->{90/89,89/87,58/45},24->{45/44,88/87,58/45},25->{120/199,119/116,58/45},26->{56/55,55/54,9/7},27->{42/41,82/81,9/7},28->{84/83,83/81,9/7},29->{64/63,49/48,9/7},30->{70/69,46/45,9/7},31->{40/39,91/90,9/7},32->{112/111,37/36,9/7},33->{81/80,2240/2187,9/7},34->{9/7,119/117,52/51},35->{54/53,53/52,104/81},36->{81/79,79/78,104/81},37->{81/80,40/39,104/81},38->{52/51,51/50,50/39},39->{39/38,76/75,50/39},40->{78/77,77/75,50/39},41->{50/49,49/48,32/25},42->{75/73,73/72,32/25},43->{75/74,37/36,32/25},44->{48/47,47/46,23/18},45->{36/35,70/69,23/18},46->{72/71,71/69,23/18},47->{30/29,116/115,23/18},48->{60/59,118/115,23/18},49->{46/45,45/44,88/69},50->{69/67,67/66,88/69},51->{69/68,34/33,88/69},52->{320/313,313/306,51/40},53->{480/473,473/459,51/40},54->{240/233,466/459,51/40},55->{44/43,43/42,14/11},56->{33/32,64/63,14/11},57->{66/65,65/63,14/11},58->{88/87,29/28,14/11},59->{36/35,55/54,14/11},60->{50/49,77/75,14/11},61->{14/11,143/140,40/39},62->{42/41,41/40,80/63},63->{63/61,61/60,80/63},64->{63/62,31/30,80/63},65->{208/203,203/198,33/26},66->{312/307,307/297,33/26},67->{312/302,302/297,33/26},68->{52/51,34/33,33/26},69->{26/25,100/99,33/26},70->{78/77,28/27,33/26},71->{40/39,39/38,19/15},72->{30/29,58/57,19/15},73->{60/59,59/57,19/15},74->{28/27,135/133,19/15},75->{512/499,499/486,81/64},76->{384/371,742/729,81/64},77->{768/755,755/729,81/64},78->{40/39,416/405,81/64},79->{128/125,250/243,81/64},80->{64/63,28/27,81/64},81->{282429536481/274877906944,70368744177664/68630377364883,81/64},82->{36/35,2240/2187,81/64},83->{38/37,37/36,24/19},84->{57/55,55/54,24/19},85->{57/56,28/27,24/19},86->{76/75,25/24,24/19},87->{40/39,117/95,24/19},88->{36/35,35/34,34/27},89->{27/26,52/51,34/27},90->{54/53,53/51,34/27},91->{24/23,69/68,34/27},92->{240/233,233/266,113/90},93->{180/173,346/339,113/90},94->{360/353,353/339,113/90},95->{30/29,116/113,113/90},96->{40/39,117/113,113/90},97->{60/59,118/113,113/90},98->{34/33,33/32,64/51},99->{51/50,25/24,64/51},100->{49/48,51/49,64/51},101->{68/65,65/64,64/51},102->{68/67,67/64,64/51},103->{32/31,31/30,5/4},104->{46/45,24/23,5/4},105->{48/47,47/45,54},106->{28/27,36/35,5/4},107->{56/55,22/21,5/4},108->{40/39,26/25,5/4},109->{25/24,128/125,5/4},110->{21/20,64/63,5/4},111->{256/243,81/80,5/4},112->{76/75,20/19,5/4},113->{96/95,19/18,5/4},114->{136/135,18/17,5/4},115->{256/255,17/16,5/4},116->{68/65,5/4,52/51},117->{4374/4235,4235/4096,8192/6561},118->{6561/6283,6283/6144,8192/6561},119->{6561/6422,3211/3072,8192/6561},120->{282429536481/274877906944,134217728/129140163,8192/6561},121->{30/29,29/28,56/45},122->{45/43,43/42,56/45},123->{45/44,22/21,56/45},124->{25/24,36/35,56/45},125->{80/77,33/32,56/45},126->{60/59,59/56,56/45},127->{40/39,117/112,56/45},128->{26/25,375/364,56/45},129->{88/85,85/82,41/33},130->{42/41,22/21,41/33},131->{44/43,43/41,41/33},132->{29/28,28/27,36/29},133->{87/85,85/81,36/29},134->{87/83,83/81,36/29},135->{28/27,27/26,26/21},136->{21/20,40/39,26/21},137->{42/41,41/39,26/21},138->{24/23,161/156,26/21},139->{136/131,131/126,21/17},140->{102/97,194/189,21/17},141->{204/199,199/189,21/17},142->{64/63,17/16,21/17},143->{34/33,22/21,21/17},144->{40/39,221/210,21/17},145->{24/23,391/378,21/17},146->{28/27,51/49,21/17},147->{27/26,26/25,100/81},148->{81/77,77/75,100/81},149->{81/79,79/75,100/81},150->{81/80,16/15,100/81},151->{51/50,18/17,100/81},152->{36/35,21/20,100/81},153->{40/39,1053/1000,100/81},154->{135/128,128/125,100/81},155->{24/23,207/200,100/81},156->{80/77,77/74,37/30},157->{20/19,38/37,37/30},158->{40/39,39/37,37/30},159->{30/29,116/111,37/30},160->{60/59,118/111,37/30},161->{26/25,25/24,16/13},162->{39/37,37/36,16/13},163->{39/38,19/18,16/13},164->{65/64,16/15,16/13},165->{52/51,17/16,16/13},166->{40/39,169/160,16/13},167->{28/27,117/112,16/13},168->{169/168,14/13,16/13},169->{22/21,91/88,16/13},170->{176/169,169/162,27/22},171->{132/125,250/243,27/22},172->{264/257,257/243,27/22},173->{28/27,22/21,27/22},174->{55/54,16/15,27/22},175->{40/39,143/135,27/22},176->{24/23,23/22,11/9},177->{18/17,34/33,11/9},178->{36/35,35/33,11/9},179->{45/44,16/15,11/9},180->{56/55,15/14,11/9},181->{78/77,14/13,11/9},182->{20/19,57/55,11/9},183->{30/29,58/55,11/9},184->{28/27,81/77,11/9},185->{40/39,117/110,11/9},186->{256/245,245/234,39/32},187->{384/373,373/351,39/32},188->{192/181,362/351,39/32},189->{64/63,14/13,39/32},190->{23/22,22/21,28/23},191->{69/65,65/63,28/23},192->{69/67,67/63,28/23},193->{46/45,15/14,28/23},194->{112/107,107/102,17/14},195->{168/158,158/153,17/14},196->{168/163,163/153,17/14},197->{52/51,14/13,17/14},198->{28/27,18/17,17/14},199->{35/34,16/15,17/14},200->{40/39,91/85,17/14},201->{17/14,56/55,55/51},202->{17/14,56/53,53/51},203->{22/21,21/20,40/33},204->{33/32,31/30,40/33},205->{33/32,16/15,40/33},206->{55/54,27/25,40/33},207->{66/65,13/12,40/33},208->{18/17,187/180,40/33},209->{64/61,61/58,29/24},210->{16/15,30/29,29/24},211->{32/31,31/29,29/24},212->{20/19,19/18,6/5},213->{28/27,15/14,6/5},214->{30/29,29/27,6/5},215->{16/15,25/24,6/5},216->{40/39,13/12,6/5},217->{55/54,12/11,6/5},218->{65/63,14/13,6/5},219->{22/21,35/33,6/5},220->{21/20,200/189,6/5},221->{256/243,6/5,135/128},222->{60/59,59/54,6/5},223->{80/77,77/72,6/5},224->{24/23,115/108,6/5},225->{88/81,45/44,6/5},226->{46/45,6/5,25/23},227->{52/51,85/78,6/5},228->{100/99,11/10,6/5},229->{34/33,6/5,55/51},230->{6/5,35/32,64/63},231->{6/5,2240/2187,243/224},232->{56/53,53/50,25/21},233->{14/13,26/25,25/21},234->{28/27,27/25,25/21},235->{21/20,16/15,25/21},236->{40/39,273/250,25/21},237->{128/121,121/114,19/16},238->{96/89,178/171,19/16},239->{192/185,185/171,19/16},240->{20/19,19/16,16/15},241->{256/243,81/76,19/16},242->{96/95,10/9,19/16},243->{64/63,21/19,19/16},244->{40/39,104/95,19/16},245->{18/17,17/16,32/27},246->{27/25,25/24,32/27},247->{27/26,13/12,32/27},248->{28/27,243/224,32/27},249->{256/243,2187/2048,32/27},250->{81/80,10/9,32/27},251->{33/32,12/11,32/27},252->{45/44,11/10,32/27},253->{21/20,15/14,32/27},254->{135/128,16/15,32/27},255->{36/35,35/32,32/27},256->{49/48,54/49,32/27},257->{243/230,230/216,32/27},258->{243/229,229/216,32/27},259->{20/19,171/160,32/27},260->{23/22,99/92,32/27},261->{24/23,69/64,32/27},262->{40/39,351/320,32/27},263->{14/13,117/112,32/27},264->{304/287,287/270,45/38},265->{456/439,439/405,45/38},266->{228/211,422/405,45/38},267->{19/18,16/15,45/38},268->{76/75,10/9,45/38},269->{38/35,28/27,45/38},270->{88/83,83/78,13/11},271->{66/61,122/117,13/11},272->{132/127,127/117,13/11},273->{14/13,22/21,13/11},274->{40/39,11/10,13/11},275->{66/65,10/9,13/11},276->{27/26,88/81,13/11},277->{28/27,99/91,13/11},278->{224/211,211/198,33/28},279->{336/323,323/297,33/28},280->{168/155,310/297,33/28},281->{56/55,10/9,33/28},282->{16/15,35/32,33/28},283->{34/33,33/28,56/51},284->{17/16,16/15,20/17},285->{51/47,47/45,20/17},286->{51/49,49/45,20/17},287->{34/33,11/10,20/17},288->{51/50,10/9,20/17},289->{40/39,221/200,20/17},290->{28/27,153/140,20/17},291->{21/20,20/17,68/63},292->{68/65,13/12,20/17},293->{34/31,31/30,20/17},294->{68/61,61/60,20/17},295->{68/67,67/57,19/17},296->{68/67,67/60,20/17},297->{184/173,173/162,27/23},298->{276/265,265/243,27/23},299->{138/127,254/243,27/23},300->{28/27,23/21,27/23},301->{23/22,88/81,27/23},302->{46/45,10/9,27/23},303->{512/481,481/450,75/64},304->{768/737,737/675,75/64},305->{384/353,706/675,75/64},306->{16/15,75/64,16/15},307->{16/15,15/14,7/6},308->{22/21,12/11,7/6},309->{24/23,23/21,7/6},310->{20/19,38/35,7/6},311->{10/9,36/35,7/6},312->{64/63,9/8,7/6},313->{92/91,26/23,7/6},314->{256/243,243/224,7/6},315->{40/39,39/35,7/6},316->{18/17,7/6,68/63},317->{50/49,7/6,28/25},318->{14/13,7/6,52/49},319->{46/45,180/161,7/6},320->{28/27,54/49,7/6},321->{120/113,113/105,7/6},322->{60/59,118/105,7/6},323->{30/29,116/105,7/6},324->{88/81,81/77,7/6},325->{120/119,17/15,7/6},326->{27/25,7/6,200/189},327->{26/25,7/6,100/91},328->{7/6,1024/945,135/128},329->{78/73,73/68,136/117},330->{117/112,56/51,136/117},331->{117/107,107/102,136/117},332->{52/51,9/8,136/117},333->{31/29,29/27,36/31},334->{93/89,89/81,36/31},335->{93/85,85/81,36/31},336->{46/43,43/40,80/69},337->{23/21,21/20,80/69},338->{23/22,11/10,80/69},339->{46/45,9/8,80/69},340->{76/71,71/66,22/19},341->{57/52,104/99,22/19},342->{114/109,109/99,22/19},343->{19/18,12/11,22/19},344->{34/33,19/17,22/19},345->{40/39,247/220,22/19},346->{15/14,14/13,52/45},347->{45/41,41/39,52/45},348->{45/43,43/39,52/45},349->{24/23,115/104,52/45},350->{40/39,9/8,52/45},351->{18/17,85/78,52/45},352->{45/44,44/39,52/45},353->{65/63,28/25,52/45},354->{55/52,12/11,52/45},355->{60/59,59/45,52/45},356->{20/19,52/45,57/52},357->{27/26,10/9,52/45},358->{11/10,150/143,52/45},359->{104/97,97/90,15/13},360->{78/71,142/135,15/13},361->{156/149,149/135,15/13},362->{16/15,15/13,13/12},363->{26/25,10/9,15/13},364->{256/243,351/320,15/13},365->{20/19,247/225,15/13},366->{11/10,15/13,104/99},367->{12/11,15/13,143/135},368->{46/45,26/23,15/13},369->{40/39,169/150,15/13},370->{28/27,39/35,15/13},371->{91/90,8/7,15/13},372->{44/41,41/38,38/33},373->{11/10,20/19,38/33},374->{22/21,21/19,38/33},375->{160/149,149/138,23/20},376->{120/109,218/207,23/20},377->{240/229,229/207,23/20},378->{8/7,70/69,23/20},379->{40/39,26/23,23/20},380->{24/23,23/20,10/9},381->{28/27,180/161,23/20},382->{72/67,67/62,31/27},383->{108/103,103/93,31/27},384->{54/49,98/93,31/27},385->{32/31,9/8,31/27},386->{272/253,253/234,39/34},387->{408/389,389/351,39/34},388->{204/185,370/351,39/34},389->{40/39,39/34,17/15},390->{14/13,13/12,8/7},391->{19/18,21/19,8/7},392->{21/20,10/9,8/7},393->{28/27,8/7,9/8},394->{49/48,8/7,8/7},395->{35/33,11/10,8/7},396->{77/72,12/11,8/7},397->{16/15,35/32,8/7},398->{35/34,17/15,8/7},399->{25/24,8/7,28/25},400->{15/14,8/7,49/45},401->{40/39,91/80,8/7},402->{46/45,105/92,8/7},403->{18/17,119/108,8/7},404->{17/16,8/7,56/51},405->{34/33,77/68,8/7},406->{256/243,567/512,8/7},407->{150/139,139/128,256/225},408->{225/214,107/96,256/225},409->{225/203,203/192,256/225},410->{25/24,9/8,256/225},411->{176/163,163/150,25/22},412->{132/119,238/225,25/22},413->{264/251,251/225,25/22},414->{16/15,11/10,25/22},415->{88/81,27/25,25/22},416->{22/21,25/22,28/25},417->{28/27,198/175,25/22},418->{26/25,44/39,25/22},419->{27/25,25/23,92/81},420->{81/77,77/69,92/81},421->{81/73,73/69,92/81},422->{24/23,9/8,92/81},423->{27/26,26/23,92/81},424->{67/62,62/57,76/67},425->{201/181,181/171,76/67},426->{201/191,191/171,76/67},427->{256/243,76/67,5427/4864},428->{40/37,37/34,17/15},429->{10/9,18/17,17/15},430->{20/19,19/17,17/15},431->{15/14,56/51,17/15},432->{80/77,77/68,17/15},433->{12/11,55/51,17/15},434->{120/109,109/102,17/15},435->{120/113,113/102,17/15},436->{24/23,115/102,17/15},437->{160/153,9/8,17/15},438->{66/61,61/56,112/99},439->{99/94,47/42,112/99},440->{99/89,89/84,112/99},441->{10/9,297/280,112/99},442->{22/21,9/8,112/99},443->{12/11,13/12,44/39},444->{39/35,35/33,44/39},445->{39/37,37/33,44/39},446->{44/39,9/8,104/99},447->{90/83,83/76,152/135},448->{135/128,64/57,152/135},449->{135/121,121/114,152/135},450->{20/19,9/8,152/135},451->{64/59,59/54,9/8},452->{48/43,86/81,9/8},453->{96/91,91/81,9/8},454->{256/243,9/8,9/8},455->{16/15,9/8,10/9},456->{2187/2048,65536/59049,9/8},457->{9/8,12/11,88/81},458->{13/12,9/8,128/117},459->{14/13,9/8,208/189},460->{9/8,11/10,320/297},461->{9/8,15/14,448/405},462->{9/8,17/16,512/459},463->{9/8,18/17,272/243},464->{9/8,19/18,64/57},465->{56/51,9/8,68/63},466->{9/8,200/189,28/25},467->{184/171,9/8,76/69},468->{32/29,9/8,29/27},469->{121/108,9/8,128/121},470->{9/8,4096/3645,135/128},471->{9/8,7168/6561,243/224},472->{35/32,1024/945,9/8},473->{11/10,13/12,160/143},474->{12/11,11/10,10/9},475->{10/9,10/9,27/25},476->{10/9,13/12,72/65},477->{11/10,11/10,400/363},478->{12/11,12/11,121/108},479->{13/12,13/12,192/169},480->{14/13,14/13,169/147},481->{15/14,15/14,784/675},482->{2187/2048,16777216/14348907,2187/2048},483->{17/16,17/16,1024/867},484->{18/17,18/17,289/243},485->{256/243,256/243,19688/16384},486->{22/21,147/121,22/21},487->{25/24,25/24,768/625},488->{28/27,28/27,243/196},489->{34/33,34/33,363/289},490->{36/35,36/35,1225/972},491->{40/39,40/39,507/400},492->{46/45,46/45,675/529},493->{176/175,175/174,29/22},494->{25/19,931/925,148/147},495->{128/127,127/126,21/16},496->{21/16,656/651,124/123},497->{104/103,103/102,17/13},498->{17/13,429/425,100/99},499->{98/97,97/96,64/49},500->{92/91,91/90,30/23},501->{90/89,89/88,176/135},502->{88/87,87/86,43/33},503->{86/85,85/84,56/43},504->{84/83,83/82,82/63},505->{82/81,81/80,160/123},506->{13/10,250/247,76/74},507->{78/77,77/76,152/117},508->{76/75,76/75,74/57},509->{74/73,73/72,48/31},510->{70/69,69/68,136/105},511->{22/17,357/352,64/63},512->{58/57,57/56,112/87},513->{87/80,43/42,112/87},514->{87/85,85/84,112/87},515->{68/53,53/52,52/51},516->{136/133,133/130,65/51},517->{68/67,67/65,65/51},518->{34/33,66/65,65/51},519->{68/67,67/54,18/17},520->{25/24,32/31,31/25},521->{68/55,55/54,18/17},522->{68/67,67/63,21/17},523->{68/65,65/63,21/17},524->{36/35,256/243,315/256},525->{64/63,16/15,315/256},526->{64/63,2187/2048,896/729},527->{36/35,135/128,896/729},528->{28/27,2187/1792,256/243},529->{16/15,2240/2187,2187/1792},530->{28/27,128/105,135/128},531->{17/16,32/31,62/51},532->{20/19,57/47,47/45},533->{360/349,349/327,109/90},534->{24/23,115/109,109/90},535->{240/229,229/218,109/90},536->{19/18,24/23,23/19},537->{15/14,36/35,98/81},538->{28/27,16/15,135/112},539->{24/23,115/96,16/15},540->{256/243,243/230,115/96},541->{68/67,67/56,56/51},542->{68/57,19/18,18/17},543->{15/14,266/255,68/57},544->{256/243,243/229,229/192},545->{32/31,13/12,31/26},546->{240/227,227/214,107/90},547->{360/347,347/321,107/90},548->{7168/6561,36/35,1215/1024},549->{16/15,1215/1024,256/243},550->{28/27,1024/945,1215/1024},551->{120/113,113/106,53/45},552->{180/173,173/159,53/45},553->{90/83,166/159,53/45},554->{24/23,115/106,53/45},555->{34/29,58/57,19/17},556->{10/9,117/100,40/39},557->{120/113,113/97,97/90},558->{13/12,55/52,64/55},559->{68/65,65/56,56/51},560->{12/11,297/256,256/243},561->{28/27,81/70,10/9},562->{81/70,2240/2187,9/8},563->{81/70,256/243,35/32},564->{135/128,7168/6561,81/70},565->{60/59,59/51,17/15},566->{40/37,37/32,16/15},567->{16/15,280/243,243/224},568->{36/35,9/8,280/243},569->{8/7,81/80,280/243},570->{46/45,132/115,25/22},571->{16/15,12/11,55/48},572->{10/9,63/55,22/21},573->{30/29,116/103,103/90},574->{360/343,343/309,103/90},575->{40/39,143/125,25/22},576->{68/65,65/57,19/17},577->{256/243,729/640,10/9},578->{30/29,58/51,17/15},579->{23/21,14/13,26/23},580->{23/22,44/39,26/23},581->{14/13,260/231,11/10},582->{4096/3645,35/32,243/224},583->{38/35,35/32,64/57},584->{19/17,17/16,64/57},585->{11/10,95/88,64/57},586->{240/221,221/202,101/90},587->{15/14,112/101,101/90},588->{120/113,113/101,101/90},589->{533/483,575/533,28/25},590->{19/17,85/76,16/15},591->{19/17,1156/1083,19/17},592->{68/63,21/19,19/17},593->{10/9,108/97,97/90}
|>;

Protect[tetrachords] ;

Unprotect[knownRatios] ;
knownRatios = <|1->"unison, perfect prime",2->"octave",3/2->"perfect fifth",4/3->"perfect fourth",5/3->"major sixth, BP sixth",5/4->"major third",6/5->"minor third",7/3->"minimal tenth, BP tenth",7/4->"harmonic seventh",7/5->"septimal or Huygens' tritone, BP fourth",7/6->"septimal minor third",8/5->"minor sixth",8/7->"septimal whole tone",9/4->"major ninth",9/5->"just minor seventh, BP seventh",9/7->"septimal major third, BP third",9/8->"major whole tone",10/7->"Euler's tritone",10/9->"minor whole tone",11/5->"neutral ninth",11/6->"21/4-tone, undecimal neutral seventh",11/7->"undecimal augmented fifth",11/8->"undecimal semi-augmented fourth",11/9->"undecimal neutral third",11/10->"4/5-tone, Ptolemy's second",12/7->"septimal major sixth",12/11->"3/4-tone, undecimal neutral second",13/7->"16/3-tone",13/8->"tridecimal neutral sixth",13/9->"tridecimal diminished fifth",13/10->"tridecimal semi-diminished fourth",13/11->"tridecimal minor third",13/12->"tridecimal 2/3-tone",14/9->"septimal minor sixth",14/11->"undecimal diminished fourth or major third",14/13->"2/3-tone",15/7->"septimal minor ninth, BP ninth",15/8->"classic major seventh",15/11->"undecimal augmented fourth",15/13->"tridecimal 5/4-tone",15/14->"major diatonic semitone",16/7->"septimal major ninth",16/9->"Pythagorean minor seventh",16/11->"undecimal semi-diminished fifth",16/13->"tridecimal neutral third",16/15->"minor diatonic semitone",17/8->"septendecimal minor ninth",17/9->"septendecimal major seventh",17/10->"septendecimal diminished seventh",17/12->"2nd septendecimal tritone",17/14->"supraminor third",17/15->"septendecimal whole tone",17/16->"17th harmonic",18/11->"undecimal neutral sixth",18/13->"tridecimal augmented fourth",18/17->"Arabic lute index finger",19/10->"undevicesimal major seventh",19/12->"undevicesimal minor sixth",19/15->"undevicesimal ditone",19/16->"19th harmonic",19/17->"quasi-meantone",19/18->"undevicesimal semitone",20/9->"small ninth",20/11->"large minor seventh",20/13->"tridecimal semi-augmented fifth",20/17->"septendecimal augmented second",20/19->"small undevicesimal semitone",21/11->"undecimal major seventh",21/16->"narrow fourth",21/17->"submajor third",21/20->"minor semitone",22/13->"tridecimal major sixth",22/15->"undecimal diminished fifth",22/21->"undecimal minor semitone",23/12->"vicesimotertial major seventh",23/16->"23rd harmonic",23/18->"vicesimotertial major third",24/13->"tridecimal neutral seventh",24/17->"1st septendecimal tritone",24/19->"smaller undevicesimal major third",24/23->"vicesimotertial minor semitone",25/9->"classic augmented eleventh, BP twelfth",25/12->"classic augmented octave",25/14->"middle minor seventh",25/16->"classic augmented fifth",25/18->"classic augmented fourth",25/21->"BP second, quasi-equal minor third",25/22->"undecimal acute whole tone",25/24->"classic chromatic semitone, minor chroma",26/15->"tridecimal semi-augmented sixth",26/25->"tridecimal 1/3-tone",27/14->"septimal major seventh",27/16->"Pythagorean major sixth",27/17->"septendecimal minor sixth",27/20->"acute fourth",27/22->"neutral third, Zalzal wosta of al-Farabi",27/23->"vicesimotertial minor third",27/25->"large limma, BP small semitone, Zarlino semitone",27/26->"tridecimal comma",28/15->"grave major seventh",28/17->"submajor sixth",28/25->"middle second",28/27->"Archytas' 1/3-tone",29/16->"29th harmonic",30/17->"septendecimal minor seventh",30/19->"smaller undevicesimal minor sixth",31/16->"31st harmonic",31/30->"31st-partial chroma",32/15->"minor ninth",32/17->"17th subharmonic",32/19->"19th subharmonic",32/21->"wide fifth",32/23->"23rd subharmonic",32/25->"classic diminished fourth",32/27->"Pythagorean minor third",32/29->"29th subharmonic",32/31->"Greek enharmonic 1/4-tone",33/25->"2 pentatones",33/26->"tridecimal major third",33/28->"undecimal minor third",33/32->"undecimal comma, al-Farabi's 1/4-tone",34/19->"quasi-mean seventh",34/21->"supraminor sixth",34/27->"septendecimal major third",35/18->"septimal semi-diminished octave",35/24->"septimal semi-diminished fifth",35/27->"9/4-tone, septimal semi-diminished fourth",35/32->"septimal neutral second",35/34->"septendecimal 1/4-tone",36/19->"smaller undevicesimal major seventh",36/25->"classic diminished fifth",36/35->"septimal diesis, 1/4-tone",37/32->"37th harmonic",39/32->"39th harmonic, Zalzal wosta of Ibn Sina",40/21->"acute major seventh",40/27->"grave fifth",40/39->"tridecimal minor diesis",42/25->"quasi-equal major sixth",44/25->"undecimal grave minor seventh",44/27->"neutral sixth",45/28->"septimale wide minor sixth",45/32->"diatonic tritone",45/44->"1/5-tone",46/45->"23rd-partial chroma",48/25->"classic diminished octave",48/35->"septimal semi-augmented fourth",49/25->"BP eighth",49/30->"larger approximation to neutral sixth",49/36->"Arabic lute acute fourth",49/40->"larger approximation to neutral third",49/45->"BP minor semitone",49/44->"undecimal minor whole tone",49/48->"slendro diesis, septimal 1/6-tone",50/27->"grave major seventh",50/33->"3 pentatones",50/49->"Erlich's decatonic comma, tritonic diesis",51/40->"septendecimal diminished fourth",51/50->"17th-partial chroma",52/33->"tridecimal minor sixth",54/35->"septimal semi-augmented fifth",54/49->"Zalzal's mujannab",55/36->"undecimal semi-augmented fifth",55/48->"undecimal semi-augmented whole tone",55/49->"quasi-equal major second",55/54->"telepathma",56/45->"septimal narrow major third",56/55->"undecimal diesis, konbini comma",57/32->"undevicesimal minor seventh",57/56->"Hendrix comma",60/49->"smaller approximation to neutral third",63/25->"quasi-equal major tenth, BP eleventh",63/32->"octave - septimal comma",63/34->"submajor seventh",63/40->"narrow minor sixth",63/50->"quasi-equal major third",64/33->"33rd subharmonic",64/35->"septimal neutral seventh",64/37->"37th subharmonic",64/39->"39th subharmonic",64/45->"2nd tritone",64/49->"2 septatones or septatonic major third",64/63->"septimal comma, Archytas' comma",65/64->"13th-partial chroma",66/65->"Winmeanma",68/35->"23/4-tone",68/63->"supraminor second",68/65->"Valentine semitone",72/49->"Arabic lute grave fifth",72/55->"undecimal semi-diminished fourth",72/59->"Ibn Sina's neutral third",74/73->"approximation to Pythagorean comma",75/49->"BP fifth",75/56->"marvelous fourth",75/64->"classic augmented second",77/64->"Keemun minor third",77/72->"undecimal secor",77/76->"approximation to 53-tone comma",78/71->"porcupine neutral second",78/77->"tridecimal minor third comma",80/49->"smaller approximation to neutral sixth",80/63->"wide major third",81/44->"2nd undecimal neutral seventh",81/50->"acute minor sixth",81/64->"Pythagorean major third",81/68->"Persian wosta",81/70->"Al-Hwarizmi's lute middle finger",81/80->"syntonic comma, Didymus comma",85/72->"septendecimal minor third",88/49->"undecimal minor seventh",88/81->"2nd undecimal neutral second",89/84->"quasi-equal semitone",91/59->"15/4-tone",91/90->"medium tridecimal comma, superleap",96/95->"19th-partial chroma",98/55->"quasi-equal minor seventh",99/70->"2nd quasi-equal tritone",99/98->"small undecimal comma",100/63->"quasi-equal minor sixth",100/81->"grave major third",100/99->"Ptolemy's comma",105/64->"septimal neutral sixth",105/104->"small tridecimal comma",112/75->"marvelous fifth",117/88->"tridecimal gentle fourth",121/120->"undecimal seconds comma, biyatisma",125/64->"classic augmented seventh, octave - minor diesis",125/72->"classic augmented sixth",125/96->"classic augmented third",125/108->"semi-augmented whole tone",125/112->"classic augmented semitone",126/125->"septimal semicomma, Starling comma",128/75->"diminished seventh",128/81->"Pythagorean minor sixth",128/105->"septimal neutral third",128/121->"undecimal semitone",128/125->"minor diesis, diesis",135/112->"septimal wide minor third",135/128->"major chroma, major limma",140/99->"quasi-equal tritone",144/125->"classic diminished third",144/143->"Grossma",145/144->"29th-partial chroma",153/125->"7/4-tone",153/152->"Ganassi's comma",160/81->"octave - syntonic comma",161/93->"19/4-tone",162/149->"Persian neutral second",168/89->"quasi-equal major seventh",169/168->"Schulter's comma",176/175->"valinorsma",192/125->"classic diminished sixth",192/175->"septimal 4/5-tone",196/195->"mynucuma",210/209->"spleen comma",216/125->"semi-augmented sixth",224/135->"narrow septimal major sixth",225/128->"augmented sixth",225/224->"septimal kleisma",231/200->"5/4-tone",241/221->"Meshaqah's 3/4-tone",243/125->"octave - maximal diesis",243/128->"Pythagorean major seventh",243/160->"acute fifth",243/200->"acute minor third",243/224->"Archytas' 2/3-tone",243/242->"neutral third comma, rastma",245/242->"Nautilus comma",245/243->"minor BP diesis, Sensamagic comma",246/239->"Meshaqah's 1/4-tone",248/243->"tricesoprimal comma",250/153->"17/4-tone",250/243->"maximal diesis, Porcupine comma",256/135->"octave - major chroma",256/225->"diminished third",256/243->"limma, Pythagorean minor second",256/245->"septimal minor semitone",256/255->"septendecimal kleisma",261/256->"vicesimononal comma",270/161->"Kirnberger's sixth",272/243->"Persian whole tone",273/256->"Ibn Sina's minor second",273/272->"Tannisma",275/273->"Garibert comma",289/288->"septendecimal minor second comma",320/243->"grave fourth",325/324->"marveltwin",351/350->"ratwolf comma",352/343->"supracomma",352/351->"minthma",361/360->"Dudon comma",364/363->"gentle comma",375/256->"double augmented fourth",375/343->"BP major semitone, minor BP chroma",385/384->"undecimal kleisma, Keemun comma",400/243->"grave major sixth",405/256->"wide augmented fifth",405/392->"greenwoodma",441/440->"Werckmeister's undecimal septenarian schisma",512/343->"3 septatones or septatonic fifth",512/375->"double diminished fifth",512/405->"narrow diminished fourth",512/507->"tridecimal neutral third comma",513/512->"undevicesimal comma, Boethius' comma",525/512->"Avicenna enharmonic diesis",540/539->"Swets' comma",625/324->"octave - major diesis",625/512->"classic neutral third",625/567->"BP great semitone, major BP chroma",640/637->"huntma",648/625->"major diesis",675/512->"wide augmented third",676/675->"island comma",686/675->"senga",687/500->"11/4-tone",715/714->"septendecimal bridge comma",729/400->"acute minor seventh",729/512->"Pythagorean tritone",729/640->"acute major second",729/704->"undecimal major diesis",729/728->"squbema",736/729->"vicesimotertial comma",749/500->"ancient Chinese quasi-equal fifth",750/749->"ancient Chinese tempering",800/729->"grave whole tone",847/845->"Cuthbert comma",875/864->"keema",896/891->"undecimal semicomma, pentacircle",1001/1000->"fairytale comma",1024/675->"narrow diminished sixth",1024/729->"Pythagorean diminished fifth",1029/1000->"keega",1029/1024->"gamelan residue",1053/1024->"tridecimal major diesis",1125/1024->"double augmented prime",1188/1183->"kestrel comma",1215/1024->"wide augmented second",1216/1215->"Eratosthenes' comma",1232/1215->"sensmus",1280/729->"grave minor seventh",1288/1287->"triaphonisma",1331/1323->"aphrowe",1344/1331->"hemimin",1375/1372->"moctdel",1575/1573->"Nicola",1716/1715->"lummic comma",1728/1715->"Orwell comma",1732/1731->"approximation to 1 cent",1875/1024->"double augmented sixth",2025/1024->"2 tritones",2048/1125->"double diminished octave",2048/1215->"narrow diminished seventh",2048/1875->"double diminished third",2048/2025->"diaschisma",2057/2048->"Blume comma",2058/2057->"xenisma",2080/2079->"ibnsinma",2187/1280->"acute major sixth",2187/2000->"Gorgo limma",2187/2048->"apotome",2187/2176->"septendecimal comma",2200/2197->"Parizek comma, petrma",2401/2400->"Breedsma",2430/2401->"nuwell comma",2560/2187->"grave minor third",3025/3024->"Lehmerisma",3125/3072->"small diesis, magic comma",3125/3087->"major BP diesis",3136/3125->"middle second comma",3375/2048->"double augmented fifth",3388/3375->"myhemiwell",3645/2048->"wide augmented sixth",4000/3969->"small septimal comma",4000/3993->"undecimal schisma",4096/2187->"Pythagorean diminished octave",4096/2401->"4 septatones or septatonic major sixth",4096/3375->"double diminished fourth",4096/3645->"narrow diminished third",4096/4095->"tridecimal schisma, Sagittal schismina",4131/4096->"Hunt flat 2 comma",4225/4224->"leprechaun comma",4375/4374->"ragisma",4608/4235->"Arabic neutral second",5120/5103->"Beta 5, Garibaldi comma",5625/4096->"double augmented third",6144/3125->"octave - small diesis",6144/6125->"porwell comma",6561/4096->"Pythagorean augmented fifth",6561/5120->"acute major third",6561/6125->"BP major link",6561/6250->"ripple",6561/6400->"Mathieu superdiesis",6655/6561->"Triple BP comma",6656/6655->"jacobin comma",8192/5625->"double diminished sixth",8192/6561->"Pythagorean diminished fourth",8192/8019->"undecimal minor diesis",9801/9800->"kalisma, Gauss' comma",10125/8192->"double augmented second",10240/6561->"grave minor sixth",10648/10647->"harmonisma",10935/8192->"fourth + schisma, 5-limit approximation to ET fourth",10976/10935->"hemimage",10985/10976->"cantonisma",15625/15309->"great BP diesis",15625/15552->"kleisma, semicomma majeur",16384/10125->"double diminished seventh",16384/10935->"fifth - schisma, 5-limit approximation to ET fifth",16807/16384->"cloudy",16875/16384->"double augmentation diesis, Negri comma",16875/16807->"small BP diesis, mirkwai comma",17496/16807->"septimal major diesis",18225/16807->"minimal BP chroma",19657/19656->"greater harmonisma",19683/10000->"octave - minimal diesis",19683/10240->"acute major seventh",19683/16384->"Pythagorean augmented second",19683/19600->"cataharry comma",20000/19683->"minimal diesis",20480/19683->"grave minor second",21875/19683->"maximal BP chroma",23232/23231->"lesser harmonisma",26411/26244->"mechanism comma",28672/28431->"Secorian",32768/16875->"octave - double augmentation diesis",32768/19683->"Pythagorean diminished seventh",32768/16807->"5 septatones or septatonic diminished octave",32805/32768->"schisma",33075/32768->"mirwomo comma",43923/43904->"hemigail",50421/50000->"trimyna",52973/50000->"Mersenne's quasi-equal semitone",59049/32768->"Pythagorean augmented sixth",59049/57344->"Harrison's comma",64827/64000->"Squalentine",65536/32805->"octave - schisma",65536/59049->"Pythagorean diminished third",65536/65219->"orgonisma",65625/65536->"horwell comma",78125/73728->"Woolhouse semitone",78732/78125->"medium semicomma, Sensi comma",83349/78125->"BP minor link",118098/117649->"stearnsma",123201/123200->"chalmersia",131072/130321->"Hunt 19-cycle comma",147456/78125->"Woolhouse major seventh",151263/151250->"odiheim",177147/131072->"Pythagorean augmented third",179200/177147->"tolerma",194481/194480->"supraminor scintillisma",234375/234256->"sesdecal",250047/250000->"Landscape comma",262144/177147->"Pythagorean diminished sixth",262144/253125->"Passion comma",321489/320000->"varunisma",390625/196608->"octave - W\[UDoubleDot]rschmidt's comma",390625/373248->"doublewide",390625/388962->"dimcomp comma",393216/390625->"W\[UDoubleDot]rschmidt's comma",413343/390625->"BP small link",420175/419904->"wizma",531441/262144->"Pythagorean augmented seventh",531441/524288->"Pythagorean comma, ditonic comma",823543/819200->"quince",823543/820125->"complementary BP diesis",1048576/531441->"Pythagorean diminished ninth",1594323/1048576->"Pythagorean double augmented fourth",1594323/1562500->"Unicorn comma",1600000/1594323->"Amity comma, kleisma - schisma",1638400/1594323->"Immunity comma",1953125/1889568->"Shibboleth comma",2097152/1594323->"Pythagorean double diminished fifth",2109375/2097152->"semicomma, Fokker's comma",4782969/4194304->"Pythagorean double augmented prime",5000000/4782969->"sevond",8388608/4782969->"Pythagorean double diminished octave",9765625/9565938->"Fifives comma",10077696/9765625->"mynic",14348907/8388608->"Pythagorean double augmented fifth",16777216/14348907->"Pythagorean double diminished fourth",29360128/29296875->"Freivald comma",33554432/33480783->"Beta 2, septimal schisma",34171875/33554432->"Ampersand's comma",43046721/33554432->"Pythagorean double augmented second",48828125/47775744->"Sycamore comma",51018336/48828125->"nusecond",67108864/43046721->"Pythagorean double diminished seventh",67108864/66430125->"Misty comma, diaschisma - schisma",129140163/67108864->"Pythagorean double augmented sixth",129140163/128000000->"gravity comma",131072000/129140163->"roda",134217728/119574225->"whole tone - 2 schismas, 5-limit approximation to ET whole tone",134217728/129140163->"Pythagorean double diminished third",201768035/201326592->"wadisma",387420489/268435456->"Pythagorean double augmented third",536870912/387420489->"Pythagorean double diminished sixth",854296875/843308032->"Blackjack comma",1162261467/536870912->"Pythagorean double augmented seventh",1162261467/1073741824->"Pythagorean-19 comma",1220703125/1162261467->"Trithagorean comma",1220703125/1207959552->"ditonma",1224440064/1220703125->"parakleisma",6115295232/6103515625->"Vishnu comma",274877906944/274658203125->"semithirds comma",7629394531250/7625597484987->"ennealimmal comma",19073486328125/19042491875328->"'19-tone' comma",450359962737049600/450283905890997363->"monzisma",36893488147419103232/36472996377170786403->"'41-tone' comma",19383245667680019896796723/19342813113834066795298816->"Mercator's comma"|> ;
Protect[knownRatios] ;

epimorix = List[] ;
 ancestry = List[] ;

compose[choice_,factor_] := { (factor* #[[1]]), (factor * #[[1]] * #[[2]]), (factor * #[[1]] * #[[2]] * #[[3]]) } & [tetrachords[choice] ]

generate::undefined = "(!) Please define the tonic with a Hertz frequency value in the input field named 'tonic'..." ;

generate[first_,second_,tonickey_] := If[NumberQ[tonickey],Module[{perfectfifth = 3/2 ,tonicratio = 1/1},
bottom = compose[first,tonicratio] ;
top = compose[second,perfectfifth];
octave = Flatten[{ 1/1, bottom, 3/2, top } ]  ;
octavefreqs = Quantity[ N[ tonickey * #] & [ octave ], "Hertz" ] ;
decimals = N[octave] ;

(*generate Scala tuning file .scl *)
name = "tetrachords" <> ToString[first] <> "and" <> ToString[second] <> ".scl" ;
headline = "!" <> ToString[name] ;
identity = "Custom octave: bottom tetrachord is # " <> ToString[first] <> " and top tetrachord is # " <> ToString[second] <> " from John Chalmer's Divisions of the Tetrachord";
contents = { headline, "!", identity,"!","7","!"} ;
AppendTo[contents,ExportString[ Column[Rest[octave], "\n"], "Table"]] ;
go = StringRiffle[contents,"\n"] ;
Export[name,contents,"Table"]  ;
Export[name,go,"Text"] ; 
(* CloudDeploy[ExportForm[contents,"Table"],CloudObject[name],Permissions\[Rule]"Public"] ; *)

(* identify /@ octave ; *)
epimor /@ octave ;

limit =(  Max[Denominator[epimorix]] + 2 ) ;
limitHalf = ( limit / 2  );  
epimorics = {(#+1)/# } & [ Range[1,limit] ] // Flatten ; 

For[ x = 1, x < limitHalf, x++,  With[ {y = (x * 2),  z = (x * 2) +1} , AppendTo[ancestry,{ epimorics[[x]]-> epimorics[[y]], epimorics[[x]]->epimorics[[z]] }]]] ;

CellPrint[TextCell[Row[{
Print[Text[Style["YOUR CUSTOM SCALE -- DEFINED BY TETRACHORDS",Black, Bold,FontFamily->"Helevetica",24]]],
Print[Invisible["xxxxx"]],
Print[Text[Style["The tetrachords used in this scale generator are precisely those catalogued in Mr. John Chalmer's seminal work on the topic: 'Divisions of the Tetrachord'", Black,FontFamily->"Helevetica", Italic, Bold, 12]]],
Print[Invisible["xxxxx"]],
Print[Text[Style["The lower tetrachord, numbered "  <> ToString[first] <> " , instantiates the " <> ToString[classify[first]] <> " genus and comprises these ratios: "<>ToString[tetrachords[first], TraditionalForm],Black,FontFamily->"Helevetica",14]]] ,
Print[Text[Style["The upper tetrachord, numbered "  <> ToString[second] <>" , instantiates the " <> ToString[classify[second]] <> " genus and comprises these ratios: "<> ToString[tetrachords[second], TraditionalForm], Black,FontFamily->"Helevetica", 14]]],
Print[Invisible["xxxxx"]],
Print[Text[Style["Those two tetrachords produce the ratios which define this scale and tuning: "<> ToString[octave,TraditionalForm],Black,FontFamily->"Helevetica", 14]]],
Print[Text[Style[ "Decimal equivalents of the octave-tuning ratios: "  <> ToString[decimals],Black,FontFamily->"Helevetica", 14]]],
Print[Invisible["xxxxx"]],
Print[Text[Style["With a tonic-key frequency of " <> ToString[tonickey] <> " Hertz, your scale produces these note frequencies: " <> ToString[octavefreqs],Black,FontFamily->"Helevetica", 14]]],
Print[Invisible["xxxxx"]],
Print[Text[Style["Epimoricity Rating: " <> ToString[Length[epimorix]] <> " stars out of a 7-possible-stars rating" , Black,FontFamily->"Helevetica", 14]]],
Print[Invisible["xxxxx"]],
Print[Text[Style["SCALA TUNING FILE (.scl)" , Black, Bold, FontFamily->"Helevetica", 24]]],
Print[Invisible["xxxxx"]],
Print[Text[Style["A scala tuning file was generated for your scale, is named " <> ToString[name] <> " , and likely downloaded to the home directory of the user account under which you are currently logged into your computer.",  Black,FontFamily->"Helevetica", 14]]],
Print[Text[Style["You may also copy and paste the following into a text editor, then save the file as a pure text file, naming it " <> ToString[name], Black,FontFamily->"Helevetica",14]]],
Print[Invisible["xxxxxx"]],Print[Invisible["xxxxxx"]],Print[Invisible["xxxxxx"]],
Print[Text[Style[ToString[go],Black,FontFamily->"Helevetica",12]]],
Print[Invisible["xxxxxx"]]
}]]]

CellPrint[ExpressionCell[HighlightGraph[TreeGraph[Flatten[ancestry],GraphLayout->"LayeredDrawing",ImageSize -> Full ,VertexShapeFunction->{"Circle"},VertexSize->{{"Scaled",0.045}}, VertexLabels->Placed["Name", {1/2,1/2}]], Style[epimorix,Green]] ]]
]
 , Message[generate::undefined] 
]


classify[tetra_] := Module[ { hyperenharmonic = Range[1,43] , enharmonic = Range[44,131],chromatic = Range[132,358], diatonic = Range[359,593] },
If[ MemberQ[hyperenharmonic,tetra], Return["hyper-enharmonic"], Continue ] ;
If[ MemberQ[enharmonic,tetra], Return[ "enharmonic"], Continue ] ;
If[ MemberQ[chromatic,tetra], Return["chromatic"], Continue ];
If[ MemberQ[diatonic,tetra], Return["diatonic"], Continue ] ; 
]

identify[ratio_] := Module[{referenced = Keys[knownRatios] },
If[ MemberQ[referenced,ratio],Echo[ knownRatios[ratio], ToString[StandardForm[ratio]] <> ": "],Echo[ ToString[StandardForm[ratio]], ToString[StandardForm[ratio]] <> ": Unidentified ratio " ] ]  
]

epimor[candidate_] := Module[{testorama = 1}, 
If[( Numerator[candidate] - Denominator[candidate]) == 1,AppendTo[epimorix,candidate], Continue ] ;
]

progeny[incoming_] := Module[{ multiplied = List[], divided = List[], added = List[], subtracted = List[]},
For[ i=1, i<limit, i++, For[ n = 1, n < limit, n++, AppendTo[ multiplied,{ higher[[i]] -> higher[[i]]* higher[[n]] , higher[[n]] ->  higher[[n]] * higher[[i]] }]]] ;
For[ i=1, i<limit, i++, For[n=1, n<limit, n++, AppendTo[divided,{ higher[[i]]->( higher[[i]] /  higher[[n]] ), higher[[n]] -> ( higher[[n]] /  higher[[i]] ) }]]] ;
For[ i=1, i<limit, i++, For[n=1, n<limit, n++, AppendTo[added,{ higher[[i]]->( higher[[i]] + higher[[n]] ), higher[[n]] -> ( higher[[n]] +  higher[[i]] ) }]]] ;
For[ i=1, i<limit, i++, For[n=1, n<limit, n++, AppendTo[subtracted,{ higher[[i]]->( higher[[i]]-  higher[[n]] ), higher[[n]] -> ( higher[[n]] -  higher[[i]] ) }]]] ;
generaMultiplied = VertexList[Flatten[multiplied] ] ;
generaDivided = VertexList[Flatten[divided] ] ;
generaAdded = VertexList[Flatten[added] ] ;
generaSubtracted = VertexList[Flatten[subtracted] ] ;
]





